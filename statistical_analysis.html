<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistical Analysis</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="report.html">Final Report</a>
</li>
<li>
  <a href="data_visualization.html">Data Visualization</a>
</li>
<li>
  <a href="map.html">Interactive Map</a>
</li>
<li>
  <a href="statistical_analysis.html">Regression Models</a>
</li>
<li>
  <a href="mailto:&lt;bh2852@cumc.columbia.edu; wz2630@cumc.columbia.edu; al4327@cumc.columbia.edu; yy3295@cumc.columbia.edu; jl6325@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/wendyzhou7/final_group_project.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical Analysis</h1>

</div>


<pre class="r"><code>map &lt;-
  read_csv(&quot;data/HydroWASTE_v10.csv&quot;)

wwtp &lt;-
  read_csv(&quot;data/SARS-CoV-2_concentrations_measured_in_NYC_Wastewater_20231129.csv&quot;)

map_df &lt;-
  map |&gt;
  janitor::clean_names() |&gt;
  select(waste_id, wwtp_name, lat_wwtp, lon_wwtp) |&gt;
  mutate(wrrf_abbreviation = recode( wwtp_name,
    &quot;New York C   Rockaway WPCP&quot; = &quot;RK&quot;,
    &quot;New York C   Red Hook WPCP&quot; = &quot;RH&quot;,
    &quot;New York C   Port Richmond WPCP&quot; = &quot;PR&quot;,
    &quot;New York C   Oakwood Beach WPCP&quot; = &quot;OB&quot;,
    &quot;New York C   26th Ward WPCP&quot; = &quot;26W&quot;,
    &quot;New York C   Tallman Island WPCP&quot; = &quot;TI&quot;,
    &quot;New York C   North River WPCP&quot; = &quot;NR&quot;,
    &quot;New York C   Coney Island WPCP&quot; = &quot;CI&quot;,
    &quot;New York C   Jamaica WPCP&quot; = &quot;JA&quot;,
    &quot;New York C   Hunts Point WPCP&quot; = &quot;HP&quot;,
    &quot;New York C   Owls Head WPCP&quot; = &quot;OH&quot;,
    &quot;New York C   Bowery Bay WPCP&quot; = &quot;BB&quot;,
    &quot;New York C   Newtown Creek WPCP&quot; = &quot;NC&quot;,
    &quot;New York C   Wards Island WPCP&quot; = &quot;WI&quot;,
  ))

wwtp_df &lt;-
  wwtp |&gt;
  janitor:: clean_names()

merge_df &lt;- inner_join(map_df, wwtp_df, by = &quot;wrrf_abbreviation&quot;)

nyc_wastewater &lt;-
  merge_df |&gt;
  rename(concentration = concentration_sars_co_v_2_gene_target_n1_copies_l) |&gt;
  drop_na(concentration) |&gt;
  separate(sample_date, into = c(&quot;month&quot;, &quot;day&quot;, &quot;year&quot;), convert = TRUE) %&gt;% 
   mutate(
     year = as.character(year),
     month = factor(month, levels = 1:12),
     month = recode(month,
                        &quot;1&quot; = &quot;January&quot;,
                        &quot;2&quot; = &quot;February&quot;,
                        &quot;3&quot; = &quot;March&quot;,
                        &quot;4&quot; = &quot;April&quot;,
                        &quot;5&quot; = &quot;May&quot;,
                        &quot;6&quot; = &quot;June&quot;,
                        &quot;7&quot; = &quot;July&quot;,
                        &quot;8&quot; = &quot;August&quot;,
                        &quot;9&quot; = &quot;September&quot;,
                        &quot;10&quot; = &quot;October&quot;,
                        &quot;11&quot; = &quot;November&quot;,
                        &quot;12&quot; = &quot;December&quot;)) |&gt;
  select(-waste_id, -test_date, -per_capita_sars_co_v_2_load_n1_copies_per_day_per_population, -population_served_estimated, -wwtp_name, -annotation, -wrrf_abbreviation, -lon_wwtp, -lat_wwtp)

borough_wastewater &lt;-
  nyc_wastewater |&gt;
  filter(year %in% c(2021, 2022), technology == &quot;RT-qPCR&quot;) |&gt;
  group_by(month, year, wrrf_name) |&gt;
  summarise(avg_conc = mean(concentration)) |&gt;
  mutate(
    boroughs = case_match(wrrf_name,
                         &quot;26th Ward&quot; ~ &quot;Brooklyn&quot;,
                         &quot;Bowery Bay&quot; ~ &quot;Manhattan&quot;,
                         &quot;Coney Island&quot; ~ &quot;Brooklyn&quot;,
                         &quot;Hunts Point&quot; ~ &quot;Bronx&quot;,
                         &quot;Jamaica Bay&quot; ~ &quot;Queens&quot;,
                         &quot;Newtown Creek&quot; ~ &quot;Queens&quot;,
                         &quot;North River&quot; ~ &quot;Manhattan&quot;,
                         &quot;Oakwood Beach&quot; ~ &quot;Staten Island&quot;,
                         &quot;Owls Head&quot; ~ &quot;Brooklyn&quot;,
                         &quot;Port Richmond&quot; ~ &quot;Staten Island&quot;,
                         &quot;Red Hook&quot; ~ &quot;Brooklyn&quot;,
                         &quot;Rockaway&quot; ~ &quot;Queens&quot;,
                         &quot;Tallman Island&quot; ~ &quot;Queens&quot;,
                         &quot;Wards Island&quot; ~ &quot;Manhattan&quot;
                         )
  ) |&gt;
  mutate (borough_id = as.factor(case_match(
      boroughs,
      &quot;Manhattan&quot; ~ 0,
      &quot;Brooklyn&quot; ~ 1,
      &quot;Bronx&quot; ~ 2,
      &quot;Queens&quot; ~ 3,
      &quot;Staten Island&quot; ~ 4
    ))
    )
  
data_reg =
  borough_wastewater %&gt;% 
  mutate (season = case_match(month,
                        &quot;January&quot; ~ &quot;Winter&quot;,
                        &quot;February&quot; ~ &quot;Winter&quot;,
                        &quot;March&quot; ~ &quot;Spring&quot;,
                        &quot;April&quot; ~ &quot;Spring&quot;,
                        &quot;May&quot; ~ &quot;Spring&quot;,
                        &quot;June&quot; ~ &quot;Summer&quot;,
                        &quot;July&quot; ~ &quot;Summer&quot;,
                        &quot;August&quot; ~ &quot;Summer&quot;,
                        &quot;September&quot; ~ &quot;Autumn&quot;,
                        &quot;October&quot; ~ &quot;Autumn&quot;,
                        &quot;November&quot; ~ &quot;Autumn&quot;,
                        &quot;December&quot; ~ &quot;Winter&quot;)) %&gt;% 
  mutate (season_id = as.factor(case_match(
      season,
      &quot;Summer&quot; ~ 0,
      &quot;Winter&quot; ~ 1,
      &quot;Spring&quot; ~ 2,
      &quot;Autumn&quot; ~ 3,
    ))
    )</code></pre>
<p><br /></p>
<p>We created borough_id as a categorical variable by grouping
wastewater plants according to their respective five boroughs, including
Manhattan, Brooklyn, Bronx, Queens, Staten Island. We set Manhattan as
reference. We then created season_id as a categorical variable by
grouping month according to four different seasons, including summer,
autumn, winter, and spring. We set summer as the reference.</p>
<p><br /></p>
<div id="anova-for-boroughs" class="section level2">
<h2>ANOVA for Boroughs</h2>
<p><br /></p>
<div
id="distribution-of-average-covid-19-wastewater-concentration-by-borough"
class="section level4">
<h4>Distribution of Average Covid-19 Wastewater Concentration By
Borough</h4>
<p><br /></p>
<pre class="r"><code>borough_wastewater_box &lt;-
  nyc_wastewater |&gt;
  filter(year %in% c(2021, 2022), technology == &quot;RT-qPCR&quot;) |&gt;
  group_by(month, year, wrrf_name) |&gt;
  summarise(avg_conc = mean(concentration)) |&gt;
  mutate(
    boroughs = case_match(wrrf_name,
                         &quot;26th Ward&quot; ~ &quot;Brooklyn&quot;,
                         &quot;Bowery Bay&quot; ~ &quot;Manhattan&quot;,
                         &quot;Coney Island&quot; ~ &quot;Brooklyn&quot;,
                         &quot;Hunts Point&quot; ~ &quot;Bronx&quot;,
                         &quot;Jamaica Bay&quot; ~ &quot;Queens&quot;,
                         &quot;Newtown Creek&quot; ~ &quot;Queens&quot;,
                         &quot;North River&quot; ~ &quot;Manhattan&quot;,
                         &quot;Oakwood Beach&quot; ~ &quot;Staten Island&quot;,
                         &quot;Owls Head&quot; ~ &quot;Brooklyn&quot;,
                         &quot;Port Richmond&quot; ~ &quot;Staten Island&quot;,
                         &quot;Red Hook&quot; ~ &quot;Brooklyn&quot;,
                         &quot;Rockaway&quot; ~ &quot;Queens&quot;,
                         &quot;Tallman Island&quot; ~ &quot;Queens&quot;,
                         &quot;Wards Island&quot; ~ &quot;Manhattan&quot;
                         )
  ) %&gt;% 
  plot_ly(
    y = ~boroughs,
    x = ~avg_conc,
    type = &quot;box&quot;,
    color = ~boroughs,
    colors = &quot;viridis&quot;
  ) %&gt;%
  layout(
    yaxis = list(title = &quot;Boroughs&quot;),
    xaxis = list(title = &quot;Average Covid-19 Wastewater Concentration&quot;),
    showlegend = FALSE
  )

borough_wastewater_box</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-aed3e0f3bcb672e26149" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-aed3e0f3bcb672e26149">{"x":{"visdat":{"14fbb3448ed19":["function () ","plotlyVisDat"]},"cur_data":"14fbb3448ed19","attrs":{"14fbb3448ed19":{"y":{},"x":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"Boroughs","type":"category","categoryorder":"array","categoryarray":["Bronx","Brooklyn","Manhattan","Queens","Staten Island"]},"xaxis":{"domain":[0,1],"automargin":true,"title":"Average Covid-19 Wastewater Concentration"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(68,1,84,0.5)","y":["Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx"],"x":[22977.111111111109,26286.222222222226,16638.25,1104.6085714285714,10327.75,897.58444444444444,4251.6000000000004,3207.2637500000001,1587.5,8485.8466666666664,626.11111111111109,10114,2182.8000000000002,16928.125,8187.125,12727.111111111111,4499,7860.4285714285716,1580.5714285714284,7955.166666666667,3983,16825.166666666668,37614.833333333328,15373.166666666666],"type":"box","orientation":"h","name":"Bronx","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(59,82,139,0.5)","y":["Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn","Brooklyn"],"x":[19404.444444444445,16827.111111111109,29687.333333333332,11529,17335,33167.222222222219,48715.333333333328,19740,14387.75,18548.25,26761.25,8473.5,1493.3700000000001,3425.5799999999999,3217.23,1925.7028571428571,11893.75,12572,25045.5,9281.5,1412.2811111111112,2275.4955555555557,4027.3222222222221,6093.7111111111108,7312.3999999999996,8683.3999999999996,15817.799999999999,3256.1999999999998,4534.0637500000003,7257.2162500000004,12803.483749999999,16051.23875,2859.25,2709.25,3358,1240.375,11045.117777777778,11839.407777777778,24766.642222222221,17439.996666666666,661.33333333333337,1384,5637.7777777777774,1028.7142857142858,18131.428571428572,17598.714285714286,20240,22029.428571428572,2733.166666666667,2065.8000000000002,6296.6000000000004,2979.1666666666665,20056.625,21922.375,19090.75,19937.125,8759.5555555555547,8187.3999999999996,14868.299999999999,4760.3000000000002,12099,11870.555555555555,22202.111111111109,12966.555555555555,3922.7142857142858,4576.1428571428569,9454.4285714285706,5945.1428571428569,6619.4285714285716,7413.8571428571431,13782.285714285714,9596.1428571428569,2796.7142857142858,4226.8571428571431,6147.2857142857147,3153.4285714285716,8225.3333333333339,8140.333333333333,19319,11784.833333333334,5947.1666666666661,5169.333333333333,7836.166666666667,5572.666666666667,17334,23878.166666666668,42621.142857142855,18818.285714285714,37849.666666666672,31841,38890,26757,15600.166666666666,27051.666666666668,46323.833333333336,23561.5],"type":"box","orientation":"h","name":"Brooklyn","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"line":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(33,144,141,0.5)","y":["Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan","Manhattan"],"x":[22236.125,15331.444444444445,21926.222222222223,33141.333333333328,22256,35293.333333333328,14699.5,10068.75,20222.75,5913.261428571428,1622.4114285714286,1588.9071428571428,14500.5,5864,13640.5,4421.405555555556,4168.1388888888887,1975.8677777777777,7602.8000000000002,5265.8000000000002,6798.1999999999998,9933.6412500000006,11367.28875,5589.5512500000004,2465.875,1222.125,2456.5,25020.661111111112,20893.771111111109,8829.9955555555553,949.22222222222217,799.33333333333337,1214.7777777777778,23275.714285714286,21748.571428571428,13926.714285714286,3105.4000000000001,2193.75,2744.3333333333335,30695.375,15936.75,10436.5,9738.75,5457,6464.2222222222226,23515.555555555555,13045.555555555555,8235.5555555555547,3420.4285714285716,4052.5714285714284,4887.8571428571431,9602.7142857142862,9422.2857142857138,8286.1428571428569,6998.4285714285706,3800.8571428571427,2689.4285714285716,15056.5,9717.6666666666661,9460.1666666666661,9426,4488.666666666667,5263.333333333333,34502.142857142855,17849.285714285714,17145.5,46098,28600.166666666664,42995,27504,15494.166666666666,13033.666666666666],"type":"box","orientation":"h","name":"Manhattan","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"line":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(93,200,99,0.5)","y":["Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Queens"],"x":[32564.777777777777,14701.222222222223,15943.222222222223,18241.444444444445,42128,21649.222222222226,24632.777777777774,34794.222222222219,17678,11006.25,7584,15480.5,2444.8442857142859,1762.4142857142858,1184.3157142857142,3911.6928571428571,17449,13303.75,7358,16568.5,2427.1800000000003,4719.5122222222226,865.26999999999998,2015.4844444444445,9943.3999999999996,5051,5252.1999999999998,8637.2000000000007,10073.57625,12235.59375,4881.5799999999999,12271.1675,2009.375,2797.875,2382.125,1714.75,19028.678888888888,18918.675555555557,11498.332222222223,28009.443333333333,680,648.14285714285711,546.125,819.375,23868,18697.285714285714,9168.2857142857138,20251.571428571428,3818.166666666667,4342.2857142857147,1934.2,2599.8000000000002,30631.5,18325,7645.25,25493,14072.1,5833.5,5097.6000000000004,4637.7777777777774,20869.111111111109,11512.888888888889,7161.666666666667,20617.444444444445,7586,5192,3316,3752.5714285714284,13725.714285714286,6574.5714285714284,4535.1428571428569,10158.142857142857,3869.7142857142858,3236.5714285714284,1590,2217.4285714285716,18217.666666666668,12764,8964.5,15155,7919.333333333333,4613.166666666667,1478.8333333333333,5794.6666666666661,35480.857142857145,18272.142857142859,21313.5,23752.333333333332,50178.666666666672,36904.666666666672,19011,24603.166666666664,37158.833333333336,22367.833333333332,22640.833333333332,30162.666666666668],"type":"box","orientation":"h","name":"Queens","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"line":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(253,231,37,0.5)","y":["Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island","Staten Island"],"x":[16620.222222222223,19761.444444444445,21304.333333333336,32085.555555555551,8231.5,11890.25,1611.0728571428572,2129.9442857142858,8873.5,13368.25,2010.3099999999999,2718.5455555555554,11148.200000000001,9871,7070.0462500000003,8374.4150000000009,7303.25,2416.5,13599.445555555554,17642.763333333332,5424.8888888888887,1198.2222222222222,12364.142857142857,16666.571428571428,7144.8333333333339,1923.2,11339.375,24046.375,7096.3999999999996,7326.8000000000002,14307,14495.222222222223,10237.857142857143,4773.1428571428569,10738.285714285714,9793,9110.6666666666661,2960.7142857142858,13624.833333333334,14512,3648.3333333333335,5404.666666666667,20074.571428571428,21006,30185.666666666664,49603,21419.666666666668,25659.833333333332],"type":"box","orientation":"h","name":"Staten Island","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><br /></p>
</div>
<div id="anova-for-boroughs-1" class="section level4">
<h4>ANOVA for Boroughs</h4>
<pre class="r"><code># Perform ANOVA test
model_anova_borough &lt;- aov(avg_conc ~ borough_id, data = borough_wastewater)

tidy_anova_borough &lt;-
  tidy(model_anova_borough) %&gt;% 
  kbl() %&gt;% 
  kable_material(
    c(&quot;striped&quot;, &quot;hover&quot;)
  ) 

tidy_anova_borough</code></pre>
<table class=" lightable-material lightable-striped lightable-hover" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
sumsq
</th>
<th style="text-align:right;">
meansq
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
borough_id
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
202875085
</td>
<td style="text-align:right;">
50718771
</td>
<td style="text-align:right;">
0.4687958
</td>
<td style="text-align:right;">
0.7586387
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
331
</td>
<td style="text-align:right;">
35810713645
</td>
<td style="text-align:right;">
108189467
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p><br /></p>
</div>
</div>
<div id="anova-for-seasons" class="section level2">
<h2>ANOVA for Seasons</h2>
<p><br /></p>
<div
id="distribution-of-average-covid-19-wastewater-concentration-by-season"
class="section level4">
<h4>Distribution of Average Covid-19 Wastewater Concentration By
Season</h4>
<p><br /></p>
<pre class="r"><code>season_wastewater_box &lt;-
  nyc_wastewater |&gt;
  filter(year %in% c(2021, 2022), technology == &quot;RT-qPCR&quot;) |&gt;
  group_by(month, year, wrrf_name) |&gt;
  summarise(avg_conc = mean(concentration)) |&gt;
  mutate (season = case_match(month,
                        &quot;January&quot; ~ &quot;Winter&quot;,
                        &quot;February&quot; ~ &quot;Winter&quot;,
                        &quot;March&quot; ~ &quot;Spring&quot;,
                        &quot;April&quot; ~ &quot;Spring&quot;,
                        &quot;May&quot; ~ &quot;Spring&quot;,
                        &quot;June&quot; ~ &quot;Summer&quot;,
                        &quot;July&quot; ~ &quot;Summer&quot;,
                        &quot;August&quot; ~ &quot;Summer&quot;,
                        &quot;September&quot; ~ &quot;Autumn&quot;,
                        &quot;October&quot; ~ &quot;Autumn&quot;,
                        &quot;November&quot; ~ &quot;Autumn&quot;,
                        &quot;December&quot; ~ &quot;Winter&quot;)) %&gt;% 
  plot_ly(
    y = ~season,
    x = ~avg_conc,
    type = &quot;box&quot;,
    color = ~season,
    colors = &quot;viridis&quot;
  ) %&gt;%
  layout(
    yaxis = list(title = &quot;Season&quot;),
    xaxis = list(title = &quot;Average Covid-19 Wastewater Concentration&quot;),
    showlegend = FALSE
  )

season_wastewater_box</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6de9ebd395c4b1e2b467" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-6de9ebd395c4b1e2b467">{"x":{"visdat":{"14fbb557e7ee1":["function () ","plotlyVisDat"]},"cur_data":"14fbb557e7ee1","attrs":{"14fbb557e7ee1":{"y":{},"x":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"Season","type":"category","categoryorder":"array","categoryarray":["Autumn","Spring","Summer","Winter"]},"xaxis":{"domain":[0,1],"automargin":true,"title":"Average Covid-19 Wastewater Concentration"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(68,1,84,0.5)","y":["Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn","Autumn"],"x":[3922.7142857142858,3420.4285714285716,4576.1428571428569,4499,7586,5192,4052.5714285714284,10237.857142857143,9454.4285714285706,4773.1428571428569,5945.1428571428569,3316,3752.5714285714284,4887.8571428571431,6619.4285714285716,9602.7142857142862,7413.8571428571431,7860.4285714285716,13725.714285714286,6574.5714285714284,9422.2857142857138,10738.285714285714,13782.285714285714,9793,9596.1428571428569,4535.1428571428569,10158.142857142857,8286.1428571428569,2796.7142857142858,6998.4285714285706,4226.8571428571431,1580.5714285714284,3869.7142857142858,3236.5714285714284,3800.8571428571427,9110.6666666666661,6147.2857142857147,2960.7142857142858,3153.4285714285716,1590,2217.4285714285716,2689.4285714285716,8225.3333333333339,15056.5,8140.333333333333,7955.166666666667,18217.666666666668,12764,9717.6666666666661,13624.833333333334,19319,14512,11784.833333333334,8964.5,15155,9460.1666666666661,5947.1666666666661,9426,5169.333333333333,3983,7919.333333333333,4613.166666666667,4488.666666666667,3648.3333333333335,7836.166666666667,5404.666666666667,5572.666666666667,1478.8333333333333,5794.6666666666661,5263.333333333333,17334,34502.142857142855,23878.166666666668,16825.166666666668,35480.857142857145,18272.142857142859,17849.285714285714,20074.571428571428,42621.142857142855,21006,18818.285714285714,21313.5,23752.333333333332,17145.5],"type":"box","orientation":"h","name":"Autumn","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(49,104,142,0.5)","y":["Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring","Spring"],"x":[11893.75,14500.5,12572,10327.75,17449,13303.75,5864,8873.5,25045.5,13368.25,9281.5,7358,16568.5,13640.5,1412.2811111111112,4421.405555555556,2275.4955555555557,897.58444444444444,2427.1800000000003,4719.5122222222226,4168.1388888888887,2010.3099999999999,4027.3222222222221,2718.5455555555554,6093.7111111111108,865.26999999999998,2015.4844444444445,1975.8677777777777,7312.3999999999996,7602.8000000000002,8683.3999999999996,4251.6000000000004,9943.3999999999996,5051,5265.8000000000002,11148.200000000001,15817.799999999999,9871,3256.1999999999998,5252.1999999999998,8637.2000000000007,6798.1999999999998,4534.0637500000003,9933.6412500000006,7257.2162500000004,3207.2637500000001,10073.57625,12235.59375,11367.28875,7070.0462500000003,12803.483749999999,8374.4150000000009,16051.23875,4881.5799999999999,12271.1675,5589.5512500000004,2859.25,2465.875,2709.25,1587.5,2009.375,2797.875,1222.125,7303.25,3358,2416.5,1240.375,2382.125,1714.75,2456.5,11045.117777777778,25020.661111111112,11839.407777777778,8485.8466666666664,19028.678888888888,18918.675555555557,20893.771111111109,13599.445555555554,24766.642222222221,17642.763333333332,17439.996666666666,11498.332222222223,28009.443333333333,8829.9955555555553],"type":"box","orientation":"h","name":"Spring","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"line":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(53,183,121,0.5)","y":["Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer","Summer"],"x":[661.33333333333337,949.22222222222217,1384,626.11111111111109,680,648.14285714285711,799.33333333333337,5424.8888888888887,5637.7777777777774,1198.2222222222222,1028.7142857142858,546.125,819.375,1214.7777777777778,18131.428571428572,23275.714285714286,17598.714285714286,10114,23868,18697.285714285714,21748.571428571428,12364.142857142857,20240,16666.571428571428,22029.428571428572,9168.2857142857138,20251.571428571428,13926.714285714286,2733.166666666667,3105.4000000000001,2065.8000000000002,2182.8000000000002,3818.166666666667,4342.2857142857147,2193.75,7144.8333333333339,6296.6000000000004,1923.2,2979.1666666666665,1934.2,2599.8000000000002,2744.3333333333335,20056.625,30695.375,21922.375,16928.125,30631.5,18325,15936.75,11339.375,19090.75,24046.375,19937.125,7645.25,25493,10436.5,8759.5555555555547,9738.75,8187.3999999999996,8187.125,14072.1,5833.5,5457,7096.3999999999996,14868.299999999999,7326.8000000000002,4760.3000000000002,5097.6000000000004,4637.7777777777774,6464.2222222222226,12099,23515.555555555555,11870.555555555555,12727.111111111111,20869.111111111109,11512.888888888889,13045.555555555555,14307,22202.111111111109,14495.222222222223,12966.555555555555,7161.666666666667,20617.444444444445,8235.5555555555547],"type":"box","orientation":"h","name":"Summer","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"line":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(253,231,37,0.5)","y":["Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter","Winter"],"x":[19404.444444444445,22236.125,16827.111111111109,22977.111111111109,32564.777777777777,14701.222222222223,15331.444444444445,16620.222222222223,29687.333333333332,19761.444444444445,11529,15943.222222222223,18241.444444444445,21926.222222222223,17335,33141.333333333328,33167.222222222219,26286.222222222226,42128,21649.222222222226,22256,21304.333333333336,48715.333333333328,32085.555555555551,19740,24632.777777777774,34794.222222222219,35293.333333333328,14387.75,14699.5,18548.25,16638.25,17678,11006.25,10068.75,8231.5,26761.25,11890.25,8473.5,7584,15480.5,20222.75,1493.3700000000001,5913.261428571428,3425.5799999999999,1104.6085714285714,2444.8442857142859,1762.4142857142858,1622.4114285714286,1611.0728571428572,3217.23,2129.9442857142858,1925.7028571428571,1184.3157142857142,3911.6928571428571,1588.9071428571428,37849.666666666672,46098,31841,37614.833333333328,50178.666666666672,36904.666666666672,28600.166666666664,30185.666666666664,38890,49603,26757,19011,24603.166666666664,42995,15600.166666666666,27504,27051.666666666668,15373.166666666666,37158.833333333336,22367.833333333332,15494.166666666666,21419.666666666668,46323.833333333336,25659.833333333332,23561.5,22640.833333333332,30162.666666666668,13033.666666666666],"type":"box","orientation":"h","name":"Winter","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><br /></p>
</div>
<div id="anova-for-seasons-1" class="section level4">
<h4>Anova for Seasons</h4>
<pre class="r"><code># Perform ANOVA test
model_anova_season &lt;- aov(avg_conc ~ season_id, data = data_reg)

tidy_anova_season &lt;-
  tidy(model_anova_season) %&gt;% 
  kbl() %&gt;% 
  kable_material(
    c(&quot;striped&quot;, &quot;hover&quot;)
  ) 

tidy_anova_season</code></pre>
<table class=" lightable-material lightable-striped lightable-hover" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
sumsq
</th>
<th style="text-align:right;">
meansq
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
season_id
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
8191721366
</td>
<td style="text-align:right;">
2730573789
</td>
<td style="text-align:right;">
32.5841
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
332
</td>
<td style="text-align:right;">
27821867364
</td>
<td style="text-align:right;">
83800805
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p><br /></p>
<p>First, we run ANOVA test for borough_id and season_id to see if there
is a significant association between the average of wastewater covid-19
concentrations with different boroughs locations. Since p-value is
0.469, which is greater than alpha = 0.05, there is no sufficient
evidence to support a relationship between borough_id and the average
wastewater covid-19 concentration. Then we applied the same method to
season_id. The p-value is 1.7e-18, which is smaller than alpha = 0.05.
Therefore, there is sufficient evidence to support a relationship
between season_id and the average wastewater covid-19 concentration.</p>
<p><br /></p>
</div>
</div>
<div id="logistic-regression" class="section level2">
<h2>Logistic Regression</h2>
<pre class="r"><code>data_fit_logistic &lt;-
  glm(avg_conc ~ borough_id + relevel(season_id,ref = &quot;0&quot;), data = data_reg)

# Get summary of the logistic regression model
tidy_log &lt;-
  tidy(data_fit_logistic) %&gt;% 
  kbl() %&gt;% 
  kable_material(
    c(&quot;striped&quot;, &quot;hover&quot;)
  ) 

tidy_log</code></pre>
<table class=" lightable-material lightable-striped lightable-hover" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
10645.3531
</td>
<td style="text-align:right;">
1386.119
</td>
<td style="text-align:right;">
7.6799683
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
borough_id1
</td>
<td style="text-align:right;">
796.0034
</td>
<td style="text-align:right;">
1430.605
</td>
<td style="text-align:right;">
0.5564103
</td>
<td style="text-align:right;">
0.5783098
</td>
</tr>
<tr>
<td style="text-align:left;">
borough_id2
</td>
<td style="text-align:right;">
-2401.8568
</td>
<td style="text-align:right;">
2162.872
</td>
<td style="text-align:right;">
-1.1104944
</td>
<td style="text-align:right;">
0.2675995
</td>
</tr>
<tr>
<td style="text-align:left;">
borough_id3
</td>
<td style="text-align:right;">
285.7974
</td>
<td style="text-align:right;">
1430.605
</td>
<td style="text-align:right;">
0.1997738
</td>
<td style="text-align:right;">
0.8417813
</td>
</tr>
<tr>
<td style="text-align:left;">
borough_id4
</td>
<td style="text-align:right;">
-116.9582
</td>
<td style="text-align:right;">
1709.900
</td>
<td style="text-align:right;">
-0.0684006
</td>
<td style="text-align:right;">
0.9455084
</td>
</tr>
<tr>
<td style="text-align:left;">
relevel(season_id, ref = “0”)1
</td>
<td style="text-align:right;">
10302.5114
</td>
<td style="text-align:right;">
1415.932
</td>
<td style="text-align:right;">
7.2761352
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
relevel(season_id, ref = “0”)2
</td>
<td style="text-align:right;">
-2097.6283
</td>
<td style="text-align:right;">
1415.932
</td>
<td style="text-align:right;">
-1.4814473
</td>
<td style="text-align:right;">
0.1394474
</td>
</tr>
<tr>
<td style="text-align:left;">
relevel(season_id, ref = “0”)3
</td>
<td style="text-align:right;">
-808.8113
</td>
<td style="text-align:right;">
1415.932
</td>
<td style="text-align:right;">
-0.5712219
</td>
<td style="text-align:right;">
0.5682404
</td>
</tr>
</tbody>
</table>
<p><br /></p>
<p>In addition, we tried to fit a regression model by using borough_id
and season_id as explanatory variables and the average wastewater
covid-19 concentration as response variable. Almost all the p-values for
each categorical variable are greater than alpha = 0.05, except for
season_id = 2, indicating winter. Therefore, we can conclude that there
could be a trend between the average concentration of wastewater
covid-19 cases with winter season.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
